<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Contingencia e información en la explicación del comportamiento</title>
    <meta charset="utf-8" />
    <meta name="author" content="Emmanuel Alcalá" />
    <script src="dia2_files/header-attrs/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="my-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

class: title-slide center






# Contingencia e información en la explicación del comportamiento
## Día 2. Contingencias

.author[
Emmanuel Alcalá
]

.date[
11-noviembre-2022
]

&lt;img src="img/banner.png" class="user-logo" /&gt;

---
class: inverse,  middle

# Cuatro concepciones de contingencia
--

- Contingencia como contigüidad

--

- Contingencia como probabilidad diferencial 

--

- Contingencia como covarianza

--

- Contingencia como información mutua 

---

# Contingencia como contigüidad

«Decir que un reforzador es contingente a la respuesta podría significar no más que sigue a la respuesta» - "Superstition in the pigeon" - Skinner, 1948

Si se concibe la contingencia como una condición que promueve el aprendizaje o mantiene la conducta, lo anterior es falso.

--

- Diversos experimentos en los 60s mostraron que la contigüidad no es necesaria ni suficiente (aparentemente). 

--

- Por ejemplo, el procedimiento *verdaderamente aleatorio* de Rescorla, o el fenómeno de bloqueo, o el de validez relativa de Wagner.

---

Sin embargo, no significa que la contigüidad no juege un papel importante. 

--

.pull-left[
&lt;div class="figure"&gt;
&lt;img src="./img/2022-11-08-16-11-59.png" alt="ISI function (Gallistel, 1990)." width="100%" /&gt;
&lt;p class="caption"&gt;ISI function (Gallistel, 1990).&lt;/p&gt;
&lt;/div&gt;
]

--

.pull-right[
&lt;div class="figure"&gt;
&lt;img src="./img/delay_gradient.png" alt="Delay gradient (Dickinson et al, 1992)." width="100%" /&gt;
&lt;p class="caption"&gt;Delay gradient (Dickinson et al, 1992).&lt;/p&gt;
&lt;/div&gt;
]

---

# Contingencia como probabilidad diferencial

«La idea de contingencia usada aquí necesita explicarse. Por [contingencia] queremos decir el .inverse[grado de dependencia] que tiene la presentación del EI sobre la presentación previa del EC [...] Esto claramente es una función de la .inverse[proporción] de los EI que ocurren durante o en algún .inverse[tiempo especificado] que sigue al EC [...] Esas proporciones pueden formularse en términos de la .inverse[probabilidad] de que un EI ocurra dada la presencia de un EC (o dado que el EC ocurrió en un tiempo anterior designado) y la probabilidad de un EI dada la ausencia del EC.» - Rescorla, 1967

--

$$
\text{Contingencia}_p = p(\text{EI}\mid \text{EC}_t) - p(\text{EI}\mid \text{noEC}_t)
$$

---

Asumiendo que un ensayo es un `\(t\)` especificado entre el inicio y fin de un EC:

- Si el EC y noEC ocurren en un «tiempo especificado», ¿cuánto es ese tiempo? ¿Existe una ventana de 'detección'? Recordar la función ISI.

--

- Si dividimos una sesión en periodos en donde ocurren apareamientos EC-EI, donde no ocurre el EC pero sí el EI, y donde no ocurre ninguno de los dos: ¿Qué es un no ensayo como para poder computar `\(p(\text{EI}\mid \text{noEC}_t)\)`? Si un ensayo es una demarcación de dos eventos (inicio y fin de EC), ¿cuánto dura un noEC? ¿Cuántos EI deben ocurrir en un noEC?

---

.strong[¿Cómo lo hizo Rescorla?]
--

.pull-left[
&lt;div class="figure"&gt;
&lt;img src="./img/rescorla1968.png" alt="Rescorla 1968" width="70%" /&gt;
&lt;p class="caption"&gt;Rescorla 1968&lt;/p&gt;
&lt;/div&gt;
]
--

.pull-right[

- En el experimento clásico de Rescorla de 1968&lt;sup&gt;1&lt;/sup&gt;, se usaron diferentes `\(p(\text{EI}\mid \text{noEC})\)`. Se presentaron 12 ensayos de 2 min, con un intervalo entre ensayos *promedio* de 8 min.

- Los choques fueron programados aleatoriamente *en toda la sesión*. Cada segundo se evaluaba con `\(p(\text{EI})\)` si se administraba choque o no (¡los intervalos EI tenían distribución exponencial!).

]

.footnote[1."Probability of shock in the presence and absence of CS in fear conditioning"]

---

- Lo que se manipuló fue un parámetro de un proceso de Poisson (eventos por segundo): «Only the .inverse[expected] probability of US were explicitly programmed; the .inverse[actual] sequence [es decir, la distribución exponencial] of US was generated separately». Uno para el EI durante el EC, otro para el EI en su ausencia.

--


- Hubo 12 EC en cada una de las 5 sesiones de condicionamiento. En total 60 ensayos. Por ejemplo, para `\(p(\text{EI}\mid \text{EC}_t) = p(\text{EI}\mid \text{noEC}_t)=0.4\)`, la tasa de choques fue de 0.26/min, (Gallistel, 2021), que multiplicado por 60 ensayos daría 31.2 choques, en 60 ensayos; `\(31.2/60\neq 0.4\)`

--

- ¿Por qué no es 0.4? Porque lo que modeló Rescorla fue la probabilidad de recibir un choque o más durante el EC. Lo que importó fue la cantidad de EC durante los cuáles no hubo choque, del 60%.

--

- Esto podía suceder porque la probabilidad del EI se calculaba segundo a segundo. 

---

- La distribución de choques durante los no-ensayos se vería de esta manera:

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/poisson_process.png" alt="Proceso de Poisson (Gallistel, 2021)" width="40%" /&gt;
&lt;p class="caption"&gt;Proceso de Poisson (Gallistel, 2021)&lt;/p&gt;
&lt;/div&gt;
--

- El problema es separar el tiempo en intervalos. Hay intervalos de EC, de EI e intervalos EC-EC. Durante esos intervalos, en algunos ocurriría el EC/EI, en otros no (noEC/noEI). Estos no-eventos se consideran fallas de ocurrencia de EC/EI en el momento en el que .inverse[se espera que sucedan].

---

## Contingencia como correlación/covarianza

--

- Originalmente, Baum propuso que la contingencia es mejor entendida como correlación entre eventos aleatorios: la tasa de respuesta y la tasa de reforzadores. Actualmente, por alguna razón, prefiere referirse a esto como *covarianza*. 

--

- La correlación y la covarianza están relacionadas entre sí por la desviación estándar de dos vectores aleatorios

$$
`\begin{equation*}
  \text{Cov}[x, y] = \frac{1}{n} \sum_{x,y}(x - \mathbb{E}[x])(y - \mathbb{E}[y])=\frac{1}{n} \mathbf{x}_0^\top \mathbf{y}_0
\end{equation*}`
$$

`\begin{align*}
    \rho = \cos \theta &amp;= \frac{\frac{1}{n} \mathbf{x}_0^\top \mathbf{y}_0}{\sqrt{1/n}\| \mathbf{x}_0 \| \sqrt{1/n}\| \mathbf{y}_0 \| }\\
      &amp;= \frac{\mathbf{x}_0^\top \mathbf{y}_0}{\| \mathbf{x}_0 \| \| \mathbf{y}_0 \| } = \frac{\text{Cov}[x, y]}{\text{SD}[x]\times \text{SD}[y]}
\end{align*}`

---

- Baum&lt;sup&gt;2&lt;/sup&gt; traza el origen de su *ley* en la intuición de Rescorla que ya mencioné.
--

- Define la dependencia entre dos tasas de eventos en términos de covarianza incluso cuando la relación es no lineal

&lt;img src="./img/Baum_cov_nocov.png" width="50%" style="display: block; margin: auto;" /&gt;

.footnote[2 Three Laws: Allocation, Induction, and Covariance]

---

- Pero, además, una tasa es cantidad de eventos *discretos* por unidad de tiempo.

--

- Baum también sugiere que la conducta operante constituye un bucle de retroalimentación negativa

--

.pull-left[
&lt;img src="./img/baum_feedback.png" width="90%" style="display: block; margin: auto;" /&gt;

- La actividad produce reforzadores.
- Los reforzadores inducen actividad.

]

--

.pull-right[

- Suponiendo que es un aire acondicionado, con un termostato, con un punto fijo (set-point) de 24°C.

&lt;img src="./img/step_response_control.png" width="60%" style="display: block; margin: auto;" /&gt;
- Cambios en la temperatura van seguidos de cambios en el aire acondicionado.
]

---

&lt;img src="./img/step_response_control.png" width="45%" style="display: block; margin: auto;" /&gt;

- Ambos se compensan. En el límite, la diferencia entre el set-point y la temperatura ambiental es 0.

- Si obtenemos una regresión entre los cambios en la temperatura y los cambios en el aire acondicionado no dirá mucho. La correlación será de 0.

- Lo cual no significa que no haya una relación entre ambos. Simplemente, en estado estable ambas variables están en equilibrio.

- No parece que la covarianza/correlación pueda explicar el mantenimiento de la conducta. 

---

# Contingencia como información

--

- Gallistel no parece diferir con Baum en lo fundamental: «The contingencies of ordinary experience, however, are defined over time»&lt;sup&gt;3&lt;/sup&gt;.

--

- Para computar una correlación debemos tener dos vectores aleatorios: el de tasa de respuesta y el de tasa de reforzamiento.

--

- Si lo que varió Rescorla fue el parámetro de una distribución, tiene sentido que lo que comparemos sean distribuciones.
--

- En particular, si la conducta es sensible a la distribución de los intervalos entre reforzadores, podria decirse que los eventos «transmiten información sobre los demás en la medida en que la ocurrencia de un evento reduce la incertidumbre sobre el otro»&lt;sup&gt;3&lt;/sup&gt;.

.footnote[3 Gallistel et al., Temporal contigency]

---

- Una medida de contigencia, según Gallistel, debe tener en cuenta las siguientes características:

--

  - Debe ser medible.
  - Debe tener en cuenta el tiempo de ocurrencia.
  - Debe poder aplicarse a cualquier tipo de dependencia.
  - No debe depender de la discretización del tiempo en segmentos arbitrarios.

--

- En la pasada sesión definimos la información con base en dos propiedades:

  - **La información debe ser extensiva y aditiva**. La combinación de dos conjuntos de información con la misma cantidad duplican la información. 
  - **La información reduce la incertidumbre**. La cantidad de información es una función monotónica estrictamente decreciente de la incertidumbre de un evento. Cuanto más probable es un evento, menos información conlleva; cuanto menos probable, más información conlleva.

---

$$
  I(x) = -\log_b(p(x)) =  \log_b\frac{1}{p(x)}
$$

&lt;img src="dia2_files/figure-html/infox-1.png" style="display: block; margin: auto;" /&gt;

Definimos también la *entropía* como la información promedio

$$
  H(x) = \sum_{i=1}^n p_i \log_b\frac{1}{p_i}
$$

---

- Suponer un programa de IV, en el que los intervalos entre reforzadores (IRI) tienen una distribución exponencial.

&lt;img src="dia2_files/figure-html/exp-1.png" style="display: block; margin: auto;" /&gt;

- Es decir, los intervalos pequeños son más frecuentes.

--

- Los intervalos entre respuestas (iri) son más cortos en promedio. La mayoría de ellos no produce reforzadores.

--

- De vez en cuando, uno de ellos los produce.

---

- ¿Cuál es la contingencia?

--

- Si queremos medir como la tasa de respuestas reduce la incertidumbre de la ocurrencia del reforzador, podemos considerar la distribuciones de los iri con respecto a los IRI.

--

- Comenzamos, primero, estimando la distribución conjunta `\(p(\text{IRI}, \text{iri})\)`, una distribución sobre todas las posibles combinaciones de IRI,iri.

--

- De nuevo, si queremos saber cómo la distribución de respuestas en el tiempo reduce la incertidumbre de ocurrencia del reforzador, en teoría de la información queremos saber la información mutua entre dos distribuciones: 

  - ¿cuánta incertidumbre se reduce sobre los IRIs respondiendo a cierta tasa (es decir, con un iri promedio)?

$$
  I(\text{IRI};\text{iri}) = H(\text{IRI}) - H(\text{IRI}\mid \text{iri})
$$

---

## Coeficiente de incertidumbre

A partir de la información mutua, definimos una cantidad relacionada llamada *coeficiente de incertidumbre**.

$$
C_{\text{IRI,iri}}=\frac{  I(\text{IRI};\text{iri}) }{H(\text{IRI})}
$$

Dado los iri, ¿qué fracción de IRI podemos predecir? Dicho de otra manera, podemos decir qué dependencia tienen los iri con respecto a los IRI. Es decir, *una medida de contingencia*.

--

Si la distribución de IRI y de iri son independientes, la información mutua es 0. No hay contingencia. La entropía condicional de `\(IRI\)` dado `\(iri\)` es la entropía de `\(IRI\)`, dado que `\(iri\)` no conlleva información sobre `\(IRI\)` al ser independiente. Por lo tanto, `\(I(IRI;iri)\)` = 0. Esto debido a que `\(H(IRI|iri)\)` es la entropía de `\(p(IRI|iri)\)`.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "atom-one-light",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
